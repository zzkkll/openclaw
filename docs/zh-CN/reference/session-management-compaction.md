---
read_when:
  - ä½ éœ€è¦è°ƒè¯•ä¼šè¯ IDã€å¯¹è¯è®°å½• JSONL æˆ– sessions.json å­—æ®µ
  - ä½ æ­£åœ¨ä¿®æ”¹è‡ªåŠ¨å‹ç¼©è¡Œä¸ºæˆ–æ·»åŠ "å‹ç¼©å‰"æ¸…ç†é€»è¾‘
  - ä½ æƒ³è¦å®ç°è®°å¿†åˆ·å†™æˆ–é™é»˜ç³»ç»Ÿè½®æ¬¡
summary: æ·±å…¥è§£æï¼šä¼šè¯å­˜å‚¨ + å¯¹è¯è®°å½•ã€ç”Ÿå‘½å‘¨æœŸåŠï¼ˆè‡ªåŠ¨ï¼‰å‹ç¼©å†…éƒ¨æœºåˆ¶
title: ä¼šè¯ç®¡ç†æ·±å…¥è§£æ
x-i18n:
  generated_at: "2026-02-01T21:37:55Z"
  model: claude-opus-4-5
  provider: pi
  source_hash: bf3715770ba634363933f6038117b6a91af11c62f5191aaaf97e6bce099bc120
  source_path: reference/session-management-compaction.md
  workflow: 15
---

# ä¼šè¯ç®¡ç†ä¸å‹ç¼©ï¼ˆæ·±å…¥è§£æï¼‰

æœ¬æ–‡æ¡£è§£é‡Š OpenClaw å¦‚ä½•ç«¯åˆ°ç«¯ç®¡ç†ä¼šè¯ï¼š

- **ä¼šè¯è·¯ç”±**ï¼ˆå…¥ç«™æ¶ˆæ¯å¦‚ä½•æ˜ å°„åˆ° `sessionKey`ï¼‰
- **ä¼šè¯å­˜å‚¨**ï¼ˆ`sessions.json`ï¼‰åŠå…¶è·Ÿè¸ªçš„å†…å®¹
- **å¯¹è¯è®°å½•æŒä¹…åŒ–**ï¼ˆ`*.jsonl`ï¼‰åŠå…¶ç»“æ„
- **å¯¹è¯è®°å½•æ¸…ç†**ï¼ˆè¿è¡Œå‰çš„æä¾›å•†ç‰¹å®šä¿®å¤ï¼‰
- **ä¸Šä¸‹æ–‡é™åˆ¶**ï¼ˆä¸Šä¸‹æ–‡çª—å£ vs è·Ÿè¸ªçš„ token æ•°ï¼‰
- **å‹ç¼©**ï¼ˆæ‰‹åŠ¨ + è‡ªåŠ¨å‹ç¼©ï¼‰ä»¥åŠå‹ç¼©å‰å·¥ä½œçš„æŒ‚é’©ä½ç½®
- **é™é»˜æ¸…ç†**ï¼ˆä¾‹å¦‚ä¸åº”äº§ç”Ÿç”¨æˆ·å¯è§è¾“å‡ºçš„è®°å¿†å†™å…¥ï¼‰

å¦‚æœä½ æƒ³å…ˆäº†è§£æ›´é«˜å±‚çº§çš„æ¦‚è§ˆï¼Œè¯·ä»ä»¥ä¸‹å†…å®¹å¼€å§‹ï¼š

- [/concepts/session](/concepts/session)
- [/concepts/compaction](/concepts/compaction)
- [/concepts/session-pruning](/concepts/session-pruning)
- [/reference/transcript-hygiene](/reference/transcript-hygiene)

---

## æ•°æ®æºï¼šGatewayç½‘å…³

OpenClaw å›´ç»•å•ä¸ª **Gatewayç½‘å…³è¿›ç¨‹**è®¾è®¡ï¼Œè¯¥è¿›ç¨‹æ‹¥æœ‰ä¼šè¯çŠ¶æ€ã€‚

- UIï¼ˆmacOS åº”ç”¨ã€Web æ§åˆ¶ç•Œé¢ã€TUIï¼‰åº”å‘ Gatewayç½‘å…³æŸ¥è¯¢ä¼šè¯åˆ—è¡¨å’Œ token è®¡æ•°ã€‚
- åœ¨è¿œç¨‹æ¨¡å¼ä¸‹ï¼Œä¼šè¯æ–‡ä»¶ä½äºè¿œç¨‹ä¸»æœºä¸Šï¼›"æ£€æŸ¥æœ¬åœ° Mac æ–‡ä»¶"ä¸ä¼šåæ˜  Gatewayç½‘å…³æ­£åœ¨ä½¿ç”¨çš„å†…å®¹ã€‚

---

## ä¸¤ä¸ªæŒä¹…åŒ–å±‚

OpenClaw é€šè¿‡ä¸¤ä¸ªå±‚æŒä¹…åŒ–ä¼šè¯ï¼š

1. **ä¼šè¯å­˜å‚¨ï¼ˆ`sessions.json`ï¼‰**
   - é”®å€¼æ˜ å°„ï¼š`sessionKey -> SessionEntry`
   - ä½“ç§¯å°ã€å¯å˜ã€å¯å®‰å…¨ç¼–è¾‘ï¼ˆæˆ–åˆ é™¤æ¡ç›®ï¼‰
   - è·Ÿè¸ªä¼šè¯å…ƒæ•°æ®ï¼ˆå½“å‰ä¼šè¯ IDã€æœ€åæ´»åŠ¨æ—¶é—´ã€å¼€å…³ã€token è®¡æ•°å™¨ç­‰ï¼‰

2. **å¯¹è¯è®°å½•ï¼ˆ`<sessionId>.jsonl`ï¼‰**
   - å…·æœ‰æ ‘ç»“æ„çš„è¿½åŠ å†™å…¥å¯¹è¯è®°å½•ï¼ˆæ¡ç›®åŒ…å« `id` + `parentId`ï¼‰
   - å­˜å‚¨å®é™…å¯¹è¯ + å·¥å…·è°ƒç”¨ + å‹ç¼©æ‘˜è¦
   - ç”¨äºé‡å»ºæœªæ¥è½®æ¬¡çš„æ¨¡å‹ä¸Šä¸‹æ–‡

---

## ç£ç›˜ä½ç½®

æ¯ä¸ªæ™ºèƒ½ä½“ï¼Œåœ¨ Gatewayç½‘å…³ä¸»æœºä¸Šï¼š

- å­˜å‚¨ï¼š`~/.openclaw/agents/<agentId>/sessions/sessions.json`
- å¯¹è¯è®°å½•ï¼š`~/.openclaw/agents/<agentId>/sessions/<sessionId>.jsonl`
  - Telegram è¯é¢˜ä¼šè¯ï¼š`.../<sessionId>-topic-<threadId>.jsonl`

OpenClaw é€šè¿‡ `src/config/sessions.ts` è§£æè¿™äº›è·¯å¾„ã€‚

---

## ä¼šè¯é”®ï¼ˆ`sessionKey`ï¼‰

`sessionKey` æ ‡è¯†*ä½ æ‰€åœ¨çš„å¯¹è¯æ¡¶*ï¼ˆè·¯ç”± + éš”ç¦»ï¼‰ã€‚

å¸¸è§æ¨¡å¼ï¼š

- ä¸»/ç›´æ¥èŠå¤©ï¼ˆæ¯ä¸ªæ™ºèƒ½ä½“ï¼‰ï¼š`agent:<agentId>:<mainKey>`ï¼ˆé»˜è®¤ `main`ï¼‰
- ç¾¤ç»„ï¼š`agent:<agentId>:<channel>:group:<id>`
- æˆ¿é—´/é¢‘é“ï¼ˆDiscord/Slackï¼‰ï¼š`agent:<agentId>:<channel>:channel:<id>` æˆ– `...:room:<id>`
- å®šæ—¶ä»»åŠ¡ï¼š`cron:<job.id>`
- Webhookï¼š`hook:<uuid>`ï¼ˆé™¤éè¢«è¦†ç›–ï¼‰

è§„èŒƒè§„åˆ™è¯¦è§ [/concepts/session](/concepts/session)ã€‚

---

## ä¼šè¯ IDï¼ˆ`sessionId`ï¼‰

æ¯ä¸ª `sessionKey` æŒ‡å‘ä¸€ä¸ªå½“å‰çš„ `sessionId`ï¼ˆç»§ç»­å¯¹è¯çš„å¯¹è¯è®°å½•æ–‡ä»¶ï¼‰ã€‚

ç»éªŒæ³•åˆ™ï¼š

- **é‡ç½®**ï¼ˆ`/new`ã€`/reset`ï¼‰ä¸ºè¯¥ `sessionKey` åˆ›å»ºæ–°çš„ `sessionId`ã€‚
- **æ¯æ—¥é‡ç½®**ï¼ˆé»˜è®¤ä¸º Gatewayç½‘å…³ä¸»æœºæœ¬åœ°æ—¶é—´å‡Œæ™¨ 4:00ï¼‰åœ¨é‡ç½®è¾¹ç•Œåçš„ä¸‹ä¸€æ¡æ¶ˆæ¯æ—¶åˆ›å»ºæ–°çš„ `sessionId`ã€‚
- **ç©ºé—²è¿‡æœŸ**ï¼ˆ`session.reset.idleMinutes` æˆ–æ—§ç‰ˆ `session.idleMinutes`ï¼‰åœ¨ç©ºé—²çª—å£åæ”¶åˆ°æ¶ˆæ¯æ—¶åˆ›å»ºæ–°çš„ `sessionId`ã€‚å½“æ¯æ—¥é‡ç½®å’Œç©ºé—²è¿‡æœŸåŒæ—¶é…ç½®æ—¶ï¼Œå…ˆåˆ°æœŸçš„ä¼˜å…ˆã€‚

å®ç°ç»†èŠ‚ï¼šå†³ç­–å‘ç”Ÿåœ¨ `src/auto-reply/reply/session.ts` ä¸­çš„ `initSessionState()` å‡½æ•°ã€‚

---

## ä¼šè¯å­˜å‚¨ç»“æ„ï¼ˆ`sessions.json`ï¼‰

å­˜å‚¨çš„å€¼ç±»å‹æ˜¯ `src/config/sessions.ts` ä¸­çš„ `SessionEntry`ã€‚

å…³é”®å­—æ®µï¼ˆéå®Œæ•´åˆ—è¡¨ï¼‰ï¼š

- `sessionId`ï¼šå½“å‰å¯¹è¯è®°å½• IDï¼ˆæ–‡ä»¶åç”±æ­¤æ´¾ç”Ÿï¼Œé™¤éè®¾ç½®äº† `sessionFile`ï¼‰
- `updatedAt`ï¼šæœ€åæ´»åŠ¨æ—¶é—´æˆ³
- `sessionFile`ï¼šå¯é€‰çš„æ˜¾å¼å¯¹è¯è®°å½•è·¯å¾„è¦†ç›–
- `chatType`ï¼š`direct | group | room`ï¼ˆå¸®åŠ© UI å’Œå‘é€ç­–ç•¥ï¼‰
- `provider`ã€`subject`ã€`room`ã€`space`ã€`displayName`ï¼šç¾¤ç»„/é¢‘é“æ ‡ç­¾çš„å…ƒæ•°æ®
- å¼€å…³ï¼š
  - `thinkingLevel`ã€`verboseLevel`ã€`reasoningLevel`ã€`elevatedLevel`
  - `sendPolicy`ï¼ˆæ¯ä¼šè¯è¦†ç›–ï¼‰
- æ¨¡å‹é€‰æ‹©ï¼š
  - `providerOverride`ã€`modelOverride`ã€`authProfileOverride`
- Token è®¡æ•°å™¨ï¼ˆå°½åŠ›è€Œä¸º / ä¾èµ–æä¾›å•†ï¼‰ï¼š
  - `inputTokens`ã€`outputTokens`ã€`totalTokens`ã€`contextTokens`
- `compactionCount`ï¼šè¯¥ä¼šè¯é”®çš„è‡ªåŠ¨å‹ç¼©å®Œæˆæ¬¡æ•°
- `memoryFlushAt`ï¼šä¸Šæ¬¡å‹ç¼©å‰è®°å¿†åˆ·å†™çš„æ—¶é—´æˆ³
- `memoryFlushCompactionCount`ï¼šä¸Šæ¬¡åˆ·å†™è¿è¡Œæ—¶çš„å‹ç¼©è®¡æ•°

å­˜å‚¨å¯å®‰å…¨ç¼–è¾‘ï¼Œä½† Gatewayç½‘å…³æ˜¯æƒå¨æ¥æºï¼šéšç€ä¼šè¯è¿è¡Œï¼Œå®ƒå¯èƒ½é‡å†™æˆ–é‡æ–°æ³¨å…¥æ¡ç›®ã€‚

---

## å¯¹è¯è®°å½•ç»“æ„ï¼ˆ`*.jsonl`ï¼‰

å¯¹è¯è®°å½•ç”± `@mariozechner/pi-coding-agent` çš„ `SessionManager` ç®¡ç†ã€‚

æ–‡ä»¶æ ¼å¼ä¸º JSONLï¼š

- ç¬¬ä¸€è¡Œï¼šä¼šè¯å¤´ï¼ˆ`type: "session"`ï¼ŒåŒ…å« `id`ã€`cwd`ã€`timestamp`ã€å¯é€‰ `parentSession`ï¼‰
- ä¹‹åï¼šå¸¦ `id` + `parentId` çš„ä¼šè¯æ¡ç›®ï¼ˆæ ‘ç»“æ„ï¼‰

ä¸»è¦æ¡ç›®ç±»å‹ï¼š

- `message`ï¼šç”¨æˆ·/åŠ©æ‰‹/å·¥å…·ç»“æœæ¶ˆæ¯
- `custom_message`ï¼šæ‰©å±•æ³¨å…¥çš„æ¶ˆæ¯ï¼Œ*ä¼š*è¿›å…¥æ¨¡å‹ä¸Šä¸‹æ–‡ï¼ˆå¯ä» UI éšè—ï¼‰
- `custom`ï¼šæ‰©å±•çŠ¶æ€ï¼Œ*ä¸ä¼š*è¿›å…¥æ¨¡å‹ä¸Šä¸‹æ–‡
- `compaction`ï¼šæŒä¹…åŒ–çš„å‹ç¼©æ‘˜è¦ï¼ŒåŒ…å« `firstKeptEntryId` å’Œ `tokensBefore`
- `branch_summary`ï¼šå¯¼èˆªæ ‘åˆ†æ”¯æ—¶çš„æŒä¹…åŒ–æ‘˜è¦

OpenClaw æœ‰æ„**ä¸**"ä¿®å¤"å¯¹è¯è®°å½•ï¼›Gatewayç½‘å…³ä½¿ç”¨ `SessionManager` æ¥è¯»å†™å®ƒä»¬ã€‚

---

## ä¸Šä¸‹æ–‡çª—å£ vs è·Ÿè¸ªçš„ token

ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µå¾ˆé‡è¦ï¼š

1. **æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£**ï¼šæ¯ä¸ªæ¨¡å‹çš„ç¡¬ä¸Šé™ï¼ˆæ¨¡å‹å¯è§çš„ token æ•°ï¼‰
2. **ä¼šè¯å­˜å‚¨è®¡æ•°å™¨**ï¼šå†™å…¥ `sessions.json` çš„æ»šåŠ¨ç»Ÿè®¡ï¼ˆç”¨äº /status å’Œä»ªè¡¨æ¿ï¼‰

å¦‚æœä½ æ­£åœ¨è°ƒæ•´é™åˆ¶ï¼š

- ä¸Šä¸‹æ–‡çª—å£æ¥è‡ªæ¨¡å‹ç›®å½•ï¼ˆå¯é€šè¿‡é…ç½®è¦†ç›–ï¼‰ã€‚
- å­˜å‚¨ä¸­çš„ `contextTokens` æ˜¯è¿è¡Œæ—¶ä¼°ç®—/æŠ¥å‘Šå€¼ï¼›ä¸è¦å°†å…¶è§†ä¸ºä¸¥æ ¼ä¿è¯ã€‚

æ›´å¤šä¿¡æ¯è¯·å‚é˜… [/token-use](/token-use)ã€‚

---

## å‹ç¼©ï¼šä»€ä¹ˆæ˜¯å‹ç¼©

å‹ç¼©å°†è¾ƒæ—§çš„å¯¹è¯æ€»ç»“ä¸ºå¯¹è¯è®°å½•ä¸­çš„æŒä¹…åŒ– `compaction` æ¡ç›®ï¼Œå¹¶ä¿æŒæœ€è¿‘çš„æ¶ˆæ¯ä¸å˜ã€‚

å‹ç¼©åï¼Œåç»­è½®æ¬¡ä¼šçœ‹åˆ°ï¼š

- å‹ç¼©æ‘˜è¦
- `firstKeptEntryId` ä¹‹åçš„æ¶ˆæ¯

å‹ç¼©æ˜¯**æŒä¹…åŒ–çš„**ï¼ˆä¸åŒäºä¼šè¯ä¿®å‰ªï¼‰ã€‚å‚é˜… [/concepts/session-pruning](/concepts/session-pruning)ã€‚

---

## è‡ªåŠ¨å‹ç¼©ä½•æ—¶è§¦å‘ï¼ˆPi è¿è¡Œæ—¶ï¼‰

åœ¨åµŒå…¥å¼ Pi æ™ºèƒ½ä½“ä¸­ï¼Œè‡ªåŠ¨å‹ç¼©åœ¨ä¸¤ç§æƒ…å†µä¸‹è§¦å‘ï¼š

1. **æº¢å‡ºæ¢å¤**ï¼šæ¨¡å‹è¿”å›ä¸Šä¸‹æ–‡æº¢å‡ºé”™è¯¯ â†’ å‹ç¼© â†’ é‡è¯•ã€‚
2. **é˜ˆå€¼ç»´æŠ¤**ï¼šåœ¨æˆåŠŸçš„è½®æ¬¡ä¹‹åï¼Œå½“ï¼š

`contextTokens > contextWindow - reserveTokens`

å…¶ä¸­ï¼š

- `contextWindow` æ˜¯æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£
- `reserveTokens` æ˜¯ä¸ºæç¤ºè¯ + ä¸‹ä¸€æ¬¡æ¨¡å‹è¾“å‡ºé¢„ç•™çš„ä½™é‡

è¿™äº›æ˜¯ Pi è¿è¡Œæ—¶è¯­ä¹‰ï¼ˆOpenClaw æ¶ˆè´¹äº‹ä»¶ï¼Œä½†ç”± Pi å†³å®šä½•æ—¶å‹ç¼©ï¼‰ã€‚

---

## å‹ç¼©è®¾ç½®ï¼ˆ`reserveTokens`ã€`keepRecentTokens`ï¼‰

Pi çš„å‹ç¼©è®¾ç½®ä½äº Pi è®¾ç½®ä¸­ï¼š

```json5
{
  compaction: {
    enabled: true,
    reserveTokens: 16384,
    keepRecentTokens: 20000,
  },
}
```

OpenClaw è¿˜ä¸ºåµŒå…¥å¼è¿è¡Œå¼ºåˆ¶æ‰§è¡Œå®‰å…¨ä¸‹é™ï¼š

- å¦‚æœ `compaction.reserveTokens < reserveTokensFloor`ï¼ŒOpenClaw ä¼šå°†å…¶æå‡ã€‚
- é»˜è®¤ä¸‹é™ä¸º `20000` tokenã€‚
- è®¾ç½® `agents.defaults.compaction.reserveTokensFloor: 0` å¯ç¦ç”¨ä¸‹é™ã€‚
- å¦‚æœå·²ç»æ›´é«˜ï¼ŒOpenClaw ä¸åšä¿®æ”¹ã€‚

åŸå› ï¼šä¸ºå‹ç¼©ä¸å¯é¿å…ä¹‹å‰çš„å¤šè½®"æ¸…ç†"ï¼ˆå¦‚è®°å¿†å†™å…¥ï¼‰ç•™å‡ºè¶³å¤Ÿä½™é‡ã€‚

å®ç°ï¼š`src/agents/pi-settings.ts` ä¸­çš„ `ensurePiCompactionReserveTokens()`
ï¼ˆä» `src/agents/pi-embedded-runner.ts` è°ƒç”¨ï¼‰ã€‚

---

## ç”¨æˆ·å¯è§ç•Œé¢

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è§‚å¯Ÿå‹ç¼©å’Œä¼šè¯çŠ¶æ€ï¼š

- `/status`ï¼ˆåœ¨ä»»ä½•èŠå¤©ä¼šè¯ä¸­ï¼‰
- `openclaw status`ï¼ˆCLIï¼‰
- `openclaw sessions` / `sessions --json`
- è¯¦ç»†æ¨¡å¼ï¼š`ğŸ§¹ Auto-compaction complete` + å‹ç¼©è®¡æ•°

---

## é™é»˜æ¸…ç†ï¼ˆ`NO_REPLY`ï¼‰

OpenClaw æ”¯æŒç”¨äºåå°ä»»åŠ¡çš„"é™é»˜"è½®æ¬¡ï¼Œç”¨æˆ·ä¸åº”çœ‹åˆ°ä¸­é—´è¾“å‡ºã€‚

çº¦å®šï¼š

- åŠ©æ‰‹ä»¥ `NO_REPLY` å¼€å§‹å…¶è¾“å‡ºï¼Œè¡¨ç¤º"ä¸è¦å‘ç”¨æˆ·ä¼ é€’å›å¤"ã€‚
- OpenClaw åœ¨ä¼ é€’å±‚ä¸­å‰¥ç¦»/æŠ‘åˆ¶æ­¤æ ‡è®°ã€‚

è‡ª `2026.1.10` èµ·ï¼Œå½“éƒ¨åˆ†å—ä»¥ `NO_REPLY` å¼€å¤´æ—¶ï¼ŒOpenClaw è¿˜ä¼šæŠ‘åˆ¶**è‰ç¨¿/è¾“å…¥ä¸­çš„æµå¼ä¼ è¾“**ï¼Œå› æ­¤é™é»˜æ“ä½œä¸ä¼šåœ¨è½®æ¬¡ä¸­é€”æ³„éœ²éƒ¨åˆ†è¾“å‡ºã€‚

---

## å‹ç¼©å‰"è®°å¿†åˆ·å†™"ï¼ˆå·²å®ç°ï¼‰

ç›®æ ‡ï¼šåœ¨è‡ªåŠ¨å‹ç¼©å‘ç”Ÿä¹‹å‰ï¼Œè¿è¡Œä¸€ä¸ªé™é»˜çš„æ™ºèƒ½ä½“è½®æ¬¡ï¼Œå°†æŒä¹…çŠ¶æ€å†™å…¥ç£ç›˜ï¼ˆä¾‹å¦‚æ™ºèƒ½ä½“å·¥ä½œåŒºä¸­çš„ `memory/YYYY-MM-DD.md`ï¼‰ï¼Œä»¥é˜²å‹ç¼©æ“¦é™¤å…³é”®ä¸Šä¸‹æ–‡ã€‚

OpenClaw ä½¿ç”¨**é¢„é˜ˆå€¼åˆ·å†™**æ–¹æ³•ï¼š

1. ç›‘æ§ä¼šè¯ä¸Šä¸‹æ–‡ä½¿ç”¨é‡ã€‚
2. å½“è¶…è¿‡"è½¯é˜ˆå€¼"ï¼ˆä½äº Pi çš„å‹ç¼©é˜ˆå€¼ï¼‰æ—¶ï¼Œå‘æ™ºèƒ½ä½“è¿è¡Œé™é»˜çš„"ç«‹å³å†™å…¥è®°å¿†"æŒ‡ä»¤ã€‚
3. ä½¿ç”¨ `NO_REPLY` ä½¿ç”¨æˆ·çœ‹ä¸åˆ°ä»»ä½•å†…å®¹ã€‚

é…ç½®ï¼ˆ`agents.defaults.compaction.memoryFlush`ï¼‰ï¼š

- `enabled`ï¼ˆé»˜è®¤ï¼š`true`ï¼‰
- `softThresholdTokens`ï¼ˆé»˜è®¤ï¼š`4000`ï¼‰
- `prompt`ï¼ˆåˆ·å†™è½®æ¬¡çš„ç”¨æˆ·æ¶ˆæ¯ï¼‰
- `systemPrompt`ï¼ˆåˆ·å†™è½®æ¬¡è¿½åŠ çš„é¢å¤–ç³»ç»Ÿæç¤ºè¯ï¼‰

å¤‡æ³¨ï¼š

- é»˜è®¤çš„ prompt/systemPrompt åŒ…å« `NO_REPLY` æç¤ºä»¥æŠ‘åˆ¶ä¼ é€’ã€‚
- æ¯ä¸ªå‹ç¼©å‘¨æœŸåˆ·å†™è¿è¡Œä¸€æ¬¡ï¼ˆåœ¨ `sessions.json` ä¸­è·Ÿè¸ªï¼‰ã€‚
- åˆ·å†™ä»…åœ¨åµŒå…¥å¼ Pi ä¼šè¯ä¸­è¿è¡Œï¼ˆCLI åç«¯è·³è¿‡ï¼‰ã€‚
- å½“ä¼šè¯å·¥ä½œåŒºä¸ºåªè¯»ï¼ˆ`workspaceAccess: "ro"` æˆ– `"none"`ï¼‰æ—¶è·³è¿‡åˆ·å†™ã€‚
- å·¥ä½œåŒºæ–‡ä»¶å¸ƒå±€å’Œå†™å…¥æ¨¡å¼å‚é˜…[è®°å¿†](/concepts/memory)ã€‚

Pi ä¹Ÿåœ¨æ‰©å±• API ä¸­æš´éœ²äº† `session_before_compact` é’©å­ï¼Œä½† OpenClaw çš„åˆ·å†™é€»è¾‘ç›®å‰åœ¨ Gatewayç½‘å…³ä¾§ã€‚

---

## æ•…éšœæ’é™¤æ¸…å•

- ä¼šè¯é”®é”™è¯¯ï¼Ÿä» [/concepts/session](/concepts/session) å¼€å§‹ï¼Œç¡®è®¤ `/status` ä¸­çš„ `sessionKey`ã€‚
- å­˜å‚¨ä¸å¯¹è¯è®°å½•ä¸åŒ¹é…ï¼Ÿç¡®è®¤ Gatewayç½‘å…³ä¸»æœºä»¥åŠ `openclaw status` ä¸­çš„å­˜å‚¨è·¯å¾„ã€‚
- å‹ç¼©è¿‡äºé¢‘ç¹ï¼Ÿæ£€æŸ¥ï¼š
  - æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£ï¼ˆå¤ªå°ï¼‰
  - å‹ç¼©è®¾ç½®ï¼ˆ`reserveTokens` ç›¸å¯¹äºæ¨¡å‹çª—å£è¿‡é«˜å¯èƒ½å¯¼è‡´æ›´æ—©è§¦å‘å‹ç¼©ï¼‰
  - å·¥å…·ç»“æœè†¨èƒ€ï¼šå¯ç”¨/è°ƒæ•´ä¼šè¯ä¿®å‰ª
- é™é»˜è½®æ¬¡æ³„éœ²ï¼Ÿç¡®è®¤å›å¤ä»¥ `NO_REPLY`ï¼ˆç²¾ç¡® tokenï¼‰å¼€å¤´ï¼Œä¸”ä½ ä½¿ç”¨çš„æ„å»ºç‰ˆæœ¬åŒ…å«æµå¼ä¼ è¾“æŠ‘åˆ¶ä¿®å¤ã€‚
